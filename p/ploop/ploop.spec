Name: ploop
Version: 1.4
Release: alt1
Group: System/Base
License: GNU GPL
Summary: Ploop tools
URL: http://wiki.openvz.org/Ploop
Packager: Viacheslav Dubrovskyi <dubrsl@altlinux.org>
Source: %name-%version.tar
Patch: %name-%version-alt.patch

Requires: parted
BuildRequires: libxml2-devel

%description
This package contains tools to work with ploop devices and images.

%package -n lib%name
Summary: ploop library
Group: System/Base
%description -n lib%name
Parallels loopback (ploop) block device API library

%package -n lib%name-devel-static
Summary: Static ploop library
Group: System/Base
%description -n lib%name-devel-static
Static version of ploop library

%package -n lib%name-devel
Summary: Headers for development with ploop library
Group: System/Base
%description -n lib%name-devel
Headers of ploop library

%prep
%setup
%patch -p1

%build
make LIBDIR=%_libdir all

%install
mkdir -p %buildroot/%_sbindir
make DESTDIR=%buildroot LIBDIR=%_libdir install

#mkdir -p %buildroot/lib/udev/rules.d
#cat << EOF > %buildroot/lib/udev/rules.d/60-persistent-storage-ploop.rules
# do not edit this file, it will be overwritten on update

#KERNEL=="ploop*", GROUP="disk"

#EOF


%files
/sbin/*
%_sbindir/*
#/lib/udev/rules.d/*
%_man8dir/*

%files -n lib%name
%_libdir/libploop.so
%_lockdir/%name

%files -n lib%name-devel-static
%_libdir/libploop.a

%files -n lib%name-devel
%_includedir/%name

%changelog
* Thu Jun 14 2012 Slava Dubrovskiy <dubrsl@altlinux.org> 1.4-alt1
- New version

* Wed Apr 18 2012 Slava Dubrovskiy <dubrsl@altlinux.org> 1.2-alt1
- New version

* Sat Mar 24 2012 Slava Dubrovskiy <dubrsl@altlinux.org> 1.1-alt1
- Update to bb3948d45daf3e30d0e05f20d1442376237ac49d

* Tue Mar 13 2012 Slava Dubrovskiy <dubrsl@altlinux.org> 1.0-alt1
- build for ALT

* Tue Mar 13 2012 Kir Kolyshkin <kir@openvz.org> 1.0-1
- initial version
